# NPU (DirectML) — руководство

Этот режим позволяет выполнять инференс модели DQN из файла ONNX через ONNX Runtime и провайдер DirectML (Windows).

## Подготовка модели
- Имя по умолчанию: `snake_dqn.onnx`.
- Вход: индекс состояния (int64), форма [1,1]. Модель должна сама реализовать embedding/feature‑извлечение.
- Выход: логиты размеров [1,3] — по действиям (влево/прямо/вправо). Выбор — argmax.

## Где искать модель
Приложение ищет путь в переменной окружения `SNAKE_NPU_ONNX`. Если не задано — смотрит:
- `./`
- `models/`
- `assets/`
- `target/release/`
- `target/debug/`

## Запуск

```powershell
$env:SNAKE_NPU_ONNX = "C:\\path\\to\\snake_dqn.onnx"; cargo run --features npu-directml
```

В приложении нажмите K (переключение NPU). Режим NPU используется только во время эволюции (E).

## Замечания
- Этот режим не обучает модель; он только выполняет предсказания.
- Для обучения используйте встроенный табличный агент или DQN.
- Если выводит ошибку загрузки — проверьте соответствие входов/выходов модели и наличие DirectML EP.
